import numpy as np
import pandas as pd
import warnings

warnings.filterwarnings('ignore')


def smooth_cases(df: pd.DataFrame, window: int = 7, cutoff: int = 3) -> pd.DataFrame:
    """
    Smooth new case data

    df: pandas DataFrame
    window: rolling windown used for smoothing
    cuttoff: get start when new cases > cutoff
    """
    df = df.diff()
    # Calculate smoohted new cases
    smoothed = (df
                .rolling(7, win_type='gaussian', min_periods=1, center=True)
                .mean(std=3.4)
                .round())

    # Get start index when new cases > cutoff
    # idx_start = np.searchsorted(smoothed.values.flatten(), cutoff)

    # Filter smoothed and original based on cutoff
    # smoothed = smoothed.iloc[idx_start:]
    original = df.loc[smoothed.index]

    return original, smoothed